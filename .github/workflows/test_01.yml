name: test01_workflow

on: push

jobs:
  build_and_output_tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build
        run: make build
      - name: Make test_01.sh executable
        run: make make_.sh_files_executable     
      - name: Run tests(test_01.sh)
        run: make run_test_01.sh
      - name: Diff
        run: make diff_test
        

  code_analysis:     
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Build
        run: make build
      - name: Make *.sh files executable
        run: make make_.sh_files_executable  

      - name: Install valgrind and cppcheck
        run: make install_valgrind_and_cppcheck
      - name: Check Leaks
        run: make check_leaks

      - name: Check warnings(test_check_warnings.sh)
        run: make check_warnings

      - name: Style and Performance(test_style_and_performance.sh)
        run: make style_and_performance
      - name: Artifact style_and_performance.txt
        uses: actions/upload-artifact@v2
        with:
          name: artifact(style_and_performance.txt)
          path: ./style_and_performance.txt

        